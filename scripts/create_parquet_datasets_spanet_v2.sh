BASE_DIR=/afs/cern.ch/work/m/mmarcheg/ttHbb/ttHbb_SPANet

# Save ttHTobb_ttToSemiLep datasets to parquet
for YEAR in 2016_PreVFP 2016_PostVFP 2017 2018
do
    python $BASE_DIR/tthbb_spanet/scripts/dataset/coffea_to_parquet.py --cfg $BASE_DIR/parameters/features.yaml -i /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/coffea/output_ttHTobb_ttToSemiLep_${YEAR}.coffea -o /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/parquet/output_ttHTobb_ttToSemiLep_${YEAR}.parquet --dataset ttHTobb_ttToSemiLep_${YEAR} --ntuples /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/output_columns_spanet_input/ttHTobb_ttToSemiLep_${YEAR}/semilep_LHE
    python $BASE_DIR/tthbb_spanet/scripts/dataset/coffea_to_parquet.py --cfg $BASE_DIR/parameters/features.yaml -i /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/coffea/output_TTToSemiLeptonic_tt+B_tt+C_${YEAR}.coffea -o /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/parquet/output_TTToSemiLeptonic_tt+B_${YEAR}.parquet --dataset TTToSemiLeptonic_${YEAR} --ntuples /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/output_columns_spanet_input/TTToSemiLeptonic_${YEAR}/TTToSemiLeptonic_tt+B/semilep_LHE
    python $BASE_DIR/tthbb_spanet/scripts/dataset/coffea_to_parquet.py --cfg $BASE_DIR/parameters/features.yaml -i /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/coffea/output_TTToSemiLeptonic_tt+B_tt+C_${YEAR}.coffea -o /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/parquet/output_TTToSemiLeptonic_tt+C_${YEAR}.parquet --dataset TTToSemiLeptonic_${YEAR} --ntuples /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/output_columns_spanet_input/TTToSemiLeptonic_${YEAR}/TTToSemiLeptonic_tt+C/semilep_LHE
    python $BASE_DIR/tthbb_spanet/scripts/dataset/coffea_to_parquet.py --cfg $BASE_DIR/parameters/features.yaml -i /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/coffea/output_TTToSemiLeptonic_tt+LF_${YEAR}.coffea -o /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/parquet/output_TTToSemiLeptonic_tt+LF_${YEAR}.parquet --dataset TTToSemiLeptonic_${YEAR} --ntuples /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/output_columns_spanet_input_tt+LF/TTToSemiLeptonic_${YEAR}/TTToSemiLeptonic_tt+LF/semilep_LHE
    python $BASE_DIR/tthbb_spanet/scripts/dataset/coffea_to_parquet.py --cfg $BASE_DIR/parameters/features.yaml -i /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/coffea/output_TTbbSemiLeptonic_4f_${YEAR}.coffea -o /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/parquet/output_TTbbSemiLeptonic_4f_tt+B_${YEAR}.parquet --dataset TTbbSemiLeptonic_4f_${YEAR} --ntuples /eos/user/m/mmarcheg/ttHbb/training_datasets/spanet_v2/output_columns_spanet_input/TTbbSemiLeptonic_4f_${YEAR}/TTbbSemiLeptonic_tt+B/semilep_LHE
done
